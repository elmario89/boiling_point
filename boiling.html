<button id='runBork'>cup of coffee BORK</button>
<button id='stopBork' disabled>stop BORK</button>
<br>
<br>
<button id='runTefal'>cup of coffee Tefal</button>
<button id='stopTefal' disabled>stop Tefal</button>
<br>
<br>
<span>Time until you get fresh cup of coffee: </span> <span class='timer'></span>

<script>
  var WATER_BOILING_POINT = 100;
  var WATER_HEAT_CAPACITY = 4220;
  var SNOW_TEMP = -16;
  var EFFICIENCY_FACTOR = 0.8; // average efficiency of kettles, 1 is fully efficiency

  var heaterPower = 2200; // average electric kettle power (in kilowatts)
  var snowMass = 1.7; // average amount of kettles (liters or kilos)

  var calculateTempDifference = function(startPoint, endPoint) {
    this.tempDifference = endPoint - startPoint;
  };

  var calculateHeaterEffectivePower = function(power, efficiencyFactor) {
    this.effectivePower = power * efficiencyFactor;
  };

  var calculateHeatNeeded = function(heatCapacity, weight, tempDiff) {
    this.heatNeeded = heatCapacity * tempDiff * weight;
  };

  function calculateMinutesNeeded(heatNeeded, heatEffectivePower) {
    this.seconds = heatNeeded / heatEffectivePower
  };

  var tempDiff = new calculateTempDifference(SNOW_TEMP, WATER_BOILING_POINT);
  var heatNeeded = new calculateHeatNeeded(WATER_HEAT_CAPACITY, snowMass, tempDiff.tempDifference);
  var heaterEffectivePower = new calculateHeaterEffectivePower(heaterPower, EFFICIENCY_FACTOR);
  var timeToBoilWaterFromSnow = new calculateMinutesNeeded(heatNeeded.heatNeeded, heaterEffectivePower.effectivePower);

  console.log('The time you need to boil ' + snowMass + 'kg of snow is ' + (timeToBoilWaterFromSnow.seconds / 60) + ' minutes');

  function coffeeMachine(amount, power, startTemperature, container){
    this.amount = amount;
    this.power = power;

    var WATER_BOILING_POINT = 100;
    var WATER_HEAT_CAPACITY = 4220;
    var EFFICIENCY_FACTOR = 0.8;

    var calculateTempDiff = new calculateTempDifference(startTemperature, WATER_BOILING_POINT);
    var heatNeeded = new calculateHeatNeeded(WATER_HEAT_CAPACITY, amount, calculateTempDiff.tempDifference);
    var heaterEffectivePower = new calculateHeaterEffectivePower(power, EFFICIENCY_FACTOR);
    var getBoilingTime = new calculateMinutesNeeded(heatNeeded.heatNeeded, heaterEffectivePower.effectivePower);

    var timer, interval, minutes, seconds;

    function isReady() {
      console.log('Your coffee is ready');
    }

    function isCanceled() {
      console.log('You canceled operation');
    }

    function displayTimer(duration, container) {
      timer = duration;
      minutes = 1;
      seconds = 60;

      interval = setInterval(function () {
          minutes = parseInt(timer / 60, 10)
          seconds = parseInt(timer % 60, 10);

          minutes = minutes < 10 ? "0" + minutes : minutes;
          seconds = seconds < 10 ? "0" + seconds : seconds;

          container.textContent = minutes + ":" + seconds;

          if (--timer < 0) {
              timer = duration;
              clearInterval(interval);
          }
      }, 1000);
    }

    function clearTimer(container) {
      container.textContent = '00:00';
      clearInterval(interval);
    }

    this.run = function() {
      displayTimer(getBoilingTime.seconds, container);

      setTimeout(function(){
        isReady();
      }, getBoilingTime.seconds*1000);
    };

    this.stop = function() {
      clearTimer(container);
      isCanceled();
    };
  };

  var borkRun = document.querySelector('#runBork');
  var borkStop = document.querySelector('#stopBork')
  var tefalRun = document.querySelector('#runTefal');
  var tefalStop = document.querySelector('#stopTefal')
  var container = document.querySelector('.timer');

  function disabler(itemToDisable, bool) {
    itemToDisable.disabled = bool;
  };

  var BORK;
  borkRun.addEventListener('click', function(){
    disabler(borkStop, false);

    BORK = new coffeeMachine(0.3, 2000, 80, container);
    BORK.run();
  });

  borkStop.addEventListener('click', function(){
    disabler(borkStop, true);

    BORK.stop();
  });

  var Tefal;
  tefalRun.addEventListener('click', function(){
    disabler(tefalStop, false);

    Tefal = new coffeeMachine(0.35, 3000, 80, container);
    Tefal.run();
  });

  tefalStop.addEventListener('click', function(){
    disabler(tefalStop, true);

    Tefal.stop();
  });

</script>

